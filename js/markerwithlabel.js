// https://github.com/printercu/google-maps-utility-library-v3-read-only/tree/master/markerwithlabel
function inherits(a,b){"use strict";function c(){}c.prototype=b.prototype,a.superClass_=b.prototype,a.prototype=new c,a.prototype.constructor=a}function MarkerLabel_(a,b,c){"use strict";this.marker_=a,this.handCursorURL_=a.handCursorURL,this.labelDiv_=document.createElement("div"),this.labelDiv_.style.cssText="position: absolute; overflow: hidden;",this.eventDiv_=document.createElement("div"),this.eventDiv_.style.cssText=this.labelDiv_.style.cssText,this.eventDiv_.setAttribute("onselectstart","return false;"),this.eventDiv_.setAttribute("ondragstart","return false;"),this.crossDiv_=MarkerLabel_.getSharedCross(b)}function MarkerWithLabel(a){"use strict";a=a||{},a.labelContent=a.labelContent||"",a.labelAnchor=a.labelAnchor||new google.maps.Point(0,0),a.labelClass=a.labelClass||"markerLabels",a.labelStyle=a.labelStyle||{},a.labelInBackground=a.labelInBackground||!1,"undefined"==typeof a.labelVisible&&(a.labelVisible=!0),"undefined"==typeof a.raiseOnDrag&&(a.raiseOnDrag=!0),"undefined"==typeof a.clickable&&(a.clickable=!0),"undefined"==typeof a.draggable&&(a.draggable=!1),"undefined"==typeof a.optimized&&(a.optimized=!1),a.crossImage=a.crossImage||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/drag_cross_67_16.png",a.handCursor=a.handCursor||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/intl/en_us/mapfiles/closedhand_8_8.cur",a.optimized=!1,this.label=new MarkerLabel_(this,a.crossImage,a.handCursor),google.maps.Marker.apply(this,arguments)}inherits(MarkerLabel_,google.maps.OverlayView),MarkerLabel_.getSharedCross=function(a){"use strict";var b;return"undefined"==typeof MarkerLabel_.getSharedCross.crossDiv&&(b=document.createElement("img"),b.style.cssText="position: absolute; z-index: 1000002; display: none;",b.style.marginLeft="-8px",b.style.marginTop="-9px",b.src=a,MarkerLabel_.getSharedCross.crossDiv=b),MarkerLabel_.getSharedCross.crossDiv},MarkerLabel_.prototype.onAdd=function(){"use strict";var d,e,f,g,h,i,j,a=this,b=!1,c=!1,k=20,l="url("+this.handCursorURL_+")",m=function(a){a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},n=function(){a.marker_.setAnimation(null)};this.getPanes().markerLayer.appendChild(this.labelDiv_),this.getPanes().overlayMouseTarget.appendChild(this.eventDiv_),"undefined"==typeof MarkerLabel_.getSharedCross.processed&&(this.getPanes().markerLayer.appendChild(this.crossDiv_),MarkerLabel_.getSharedCross.processed=!0),this.listeners_=[google.maps.event.addDomListener(this.eventDiv_,"mouseover",function(b){(a.marker_.getDraggable()||a.marker_.getClickable())&&(this.style.cursor="pointer",google.maps.event.trigger(a.marker_,"mouseover",b))}),google.maps.event.addDomListener(this.eventDiv_,"mouseout",function(b){!a.marker_.getDraggable()&&!a.marker_.getClickable()||c||(this.style.cursor=a.marker_.getCursor(),google.maps.event.trigger(a.marker_,"mouseout",b))}),google.maps.event.addDomListener(this.eventDiv_,"mousedown",function(d){c=!1,a.marker_.getDraggable()&&(b=!0,this.style.cursor=l),(a.marker_.getDraggable()||a.marker_.getClickable())&&(google.maps.event.trigger(a.marker_,"mousedown",d),m(d))}),google.maps.event.addDomListener(document,"mouseup",function(e){var f;if(b&&(b=!1,a.eventDiv_.style.cursor="pointer",google.maps.event.trigger(a.marker_,"mouseup",e)),c){if(h){f=a.getProjection().fromLatLngToDivPixel(a.marker_.getPosition()),f.y+=k,a.marker_.setPosition(a.getProjection().fromDivPixelToLatLng(f));try{a.marker_.setAnimation(google.maps.Animation.BOUNCE),setTimeout(n,1406)}catch(a){}}a.crossDiv_.style.display="none",a.marker_.setZIndex(d),g=!0,c=!1,e.latLng=a.marker_.getPosition(),google.maps.event.trigger(a.marker_,"dragend",e)}}),google.maps.event.addListener(a.marker_.getMap(),"mousemove",function(g){var l;b&&(c?(g.latLng=new google.maps.LatLng(g.latLng.lat()-e,g.latLng.lng()-f),l=a.getProjection().fromLatLngToDivPixel(g.latLng),h&&(a.crossDiv_.style.left=l.x+"px",a.crossDiv_.style.top=l.y+"px",a.crossDiv_.style.display="",l.y-=k),a.marker_.setPosition(a.getProjection().fromDivPixelToLatLng(l)),h&&(a.eventDiv_.style.top=l.y+k+"px"),google.maps.event.trigger(a.marker_,"drag",g)):(e=g.latLng.lat()-a.marker_.getPosition().lat(),f=g.latLng.lng()-a.marker_.getPosition().lng(),d=a.marker_.getZIndex(),i=a.marker_.getPosition(),j=a.marker_.getMap().getCenter(),h=a.marker_.get("raiseOnDrag"),c=!0,a.marker_.setZIndex(1e6),g.latLng=a.marker_.getPosition(),google.maps.event.trigger(a.marker_,"dragstart",g)))}),google.maps.event.addDomListener(document,"keydown",function(b){c&&27===b.keyCode&&(h=!1,a.marker_.setPosition(i),a.marker_.getMap().setCenter(j),google.maps.event.trigger(document,"mouseup",b))}),google.maps.event.addDomListener(this.eventDiv_,"click",function(b){(a.marker_.getDraggable()||a.marker_.getClickable())&&(g?g=!1:(google.maps.event.trigger(a.marker_,"click",b),m(b)))}),google.maps.event.addDomListener(this.eventDiv_,"dblclick",function(b){(a.marker_.getDraggable()||a.marker_.getClickable())&&(google.maps.event.trigger(a.marker_,"dblclick",b),m(b))}),google.maps.event.addListener(this.marker_,"dragstart",function(a){c||(h=this.get("raiseOnDrag"))}),google.maps.event.addListener(this.marker_,"drag",function(b){c||h&&(a.setPosition(k),a.labelDiv_.style.zIndex=1e6+(this.get("labelInBackground")?-1:1))}),google.maps.event.addListener(this.marker_,"dragend",function(b){c||h&&a.setPosition(0)}),google.maps.event.addListener(this.marker_,"position_changed",function(){a.setPosition()}),google.maps.event.addListener(this.marker_,"zindex_changed",function(){a.setZIndex()}),google.maps.event.addListener(this.marker_,"visible_changed",function(){a.setVisible()}),google.maps.event.addListener(this.marker_,"labelvisible_changed",function(){a.setVisible()}),google.maps.event.addListener(this.marker_,"title_changed",function(){a.setTitle()}),google.maps.event.addListener(this.marker_,"labelcontent_changed",function(){a.setContent()}),google.maps.event.addListener(this.marker_,"labelanchor_changed",function(){a.setAnchor()}),google.maps.event.addListener(this.marker_,"labelclass_changed",function(){a.setStyles()}),google.maps.event.addListener(this.marker_,"labelstyle_changed",function(){a.setStyles()})]},MarkerLabel_.prototype.onRemove=function(){"use strict";var a;for(this.labelDiv_.parentNode.removeChild(this.labelDiv_),this.eventDiv_.parentNode.removeChild(this.eventDiv_),a=0;a<this.listeners_.length;a++)google.maps.event.removeListener(this.listeners_[a])},MarkerLabel_.prototype.draw=function(){"use strict";this.setContent(),this.setTitle(),this.setStyles()},MarkerLabel_.prototype.setContent=function(){"use strict";var a=this.marker_.get("labelContent");"undefined"==typeof a.nodeType?(this.labelDiv_.innerHTML=a,this.eventDiv_.innerHTML=this.labelDiv_.innerHTML):(this.labelDiv_.innerHTML="",this.labelDiv_.appendChild(a),a=a.cloneNode(!0),this.eventDiv_.innerHTML="",this.eventDiv_.appendChild(a))},MarkerLabel_.prototype.setTitle=function(){"use strict";this.eventDiv_.title=this.marker_.getTitle()||""},MarkerLabel_.prototype.setStyles=function(){"use strict";var a,b;this.labelDiv_.className=this.marker_.get("labelClass"),this.eventDiv_.className=this.labelDiv_.className,this.labelDiv_.style.cssText="",this.eventDiv_.style.cssText="",b=this.marker_.get("labelStyle");for(a in b)b.hasOwnProperty(a)&&(this.labelDiv_.style[a]=b[a],this.eventDiv_.style[a]=b[a]);this.setMandatoryStyles()},MarkerLabel_.prototype.setMandatoryStyles=function(){"use strict";this.labelDiv_.style.position="absolute",this.labelDiv_.style.overflow="hidden","undefined"!=typeof this.labelDiv_.style.opacity&&""!==this.labelDiv_.style.opacity&&(this.labelDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity='+100*this.labelDiv_.style.opacity+')"',this.labelDiv_.style.filter="alpha(opacity="+100*this.labelDiv_.style.opacity+")"),this.eventDiv_.style.position=this.labelDiv_.style.position,this.eventDiv_.style.overflow=this.labelDiv_.style.overflow,this.eventDiv_.style.opacity=.01,this.eventDiv_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(opacity=1)"',this.eventDiv_.style.filter="alpha(opacity=1)",this.setAnchor(),this.setPosition(),this.setVisible()},MarkerLabel_.prototype.setAnchor=function(){"use strict";var a=this.marker_.get("labelAnchor");this.labelDiv_.style.marginLeft=-a.x+"px",this.labelDiv_.style.marginTop=-a.y+"px",this.eventDiv_.style.marginLeft=-a.x+"px",this.eventDiv_.style.marginTop=-a.y+"px"},MarkerLabel_.prototype.setPosition=function(a){"use strict";var b=this.getProjection().fromLatLngToDivPixel(this.marker_.getPosition());"undefined"==typeof a&&(a=0),this.labelDiv_.style.left=Math.round(b.x)+"px",this.labelDiv_.style.top=Math.round(b.y-a)+"px",this.eventDiv_.style.left=this.labelDiv_.style.left,this.eventDiv_.style.top=this.labelDiv_.style.top,this.setZIndex()},MarkerLabel_.prototype.setZIndex=function(){"use strict";var a=this.marker_.get("labelInBackground")?-1:1;"undefined"==typeof this.marker_.getZIndex()?(this.labelDiv_.style.zIndex=parseInt(this.labelDiv_.style.top,10)+a,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex):(this.labelDiv_.style.zIndex=this.marker_.getZIndex()+a,this.eventDiv_.style.zIndex=this.labelDiv_.style.zIndex)},MarkerLabel_.prototype.setVisible=function(){"use strict";this.marker_.get("labelVisible")?this.labelDiv_.style.display=this.marker_.getVisible()?"block":"none":this.labelDiv_.style.display="none",this.eventDiv_.style.display=this.labelDiv_.style.display},inherits(MarkerWithLabel,google.maps.Marker),MarkerWithLabel.prototype.setMap=function(a){"use strict";google.maps.Marker.prototype.setMap.apply(this,arguments),this.label.setMap(a)};